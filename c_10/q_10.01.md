# 「世界で闘うプログラミング力を鍛える150問」問題10.1

## 問題

1000のクライアントアプリケーションから呼び出される、
単純な株価情報 (始値、終値、高値、安値) を取得するサービスを構築しているところを想像してください。
株価のデータはすでに持っており、
保持するデータの形式は何でもよいと仮定してかまいません。
クライアントアプリケーションに対して株価情報を提供するサービスをどのように設計すればよいでしょうか?
あなたには開発、運用展開、モニタリング、メンテナンスを行う責任があります。
いくつか方法を考え、なぜそれがよいのかを説明してください。
どんな技術を用いてもかまいませんし、
クライアントへのデータ配信方法も好きな方法で行ってください。

## 回答

典型的なWeb API (レスポンスはXMLやJSONなど) を考えるか、
SQL系のRDBを用いクライアントに直接クエリを投げてもらうかなどが考えられる。
いずれの方法も長所・短所があり、正しい回答は簡単に決められない。

この際に注意すべきポイントに以下が考えられる。

* クライアントにやさしいか?
* 自分たちにもやさしいか?
* 将来の要求に対し柔軟に対応できるか?
* スケーラビリティと効率は十分か?

### SQL DBを用いた提案

* メリット
  * SQLクエリに関する知識は必要になるが、クライアントの自由度が高い。
  * 既存サーバの機能が充実していて (MySQL, PostgreSQL) 開発負荷が低い。
* デメリット
  * 簡単な要求であっても多機能なSQLでは重い処理になってしまう。
  * データ確認のための実装を別途用意することになるので、けっきょくは開発負荷が低くならいなこともある。
  * アクセス制御が複雑になり、メンテナンスのコストが意外にかかる。
  * クライアントの質の低い・悪いSQLクエリで高い負荷に悩まされることがある。

### Web APIを用いた提案

以下、レスポンスをXML形式と仮定する。

* メリット
  * XMLは多くの言語で処理系が用意されているので、クライアントの開発が用意。
  * 単純にHTTPでクエリとレスポンスが成立するので配布が楽。開発も楽。
  * 追加ノードで新データを追加できる。しかもクライアントは (必要がなければ) それを無視できる。
  * ダンプ・データを保持するだけでバックアップできる簡単。
* デメリット
  * XMLの設計にもよるが、クライアントの要求以上のデータを送るケースがあり、効率が悪い。
  * クライアントはレスポンスのXML全体をパースする必要がある。
